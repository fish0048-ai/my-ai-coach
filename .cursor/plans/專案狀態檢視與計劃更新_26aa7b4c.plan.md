---
name: 專案狀態檢視與計劃更新
overview: 基於實際程式碼檢視結果，更新計劃文件以反映已完成功能、重新評估優先級，並將 AI 功能增強列為優先項目。
todos: []
---

# 專案狀態檢視與計劃更新

## 三、未來擴展功能（待規劃）

### 3.1 多平台 API 同步

**功能描述**:

- 透過 Strava、Garmin Connect、Apple Health 官方 API 自動同步資料
- 需要申請各平台 API 權限和 OAuth 流程

**實現要點**:

- 擴展 `src/services/import/platformSync.js` 的 `syncFromPlatformAPI()` 函數
- 實現 OAuth 授權流程
- 添加同步設定頁面
- 需要申請各平台 API 權限

**預期收益**: 提高資料匯入便利性，實現自動同步

---

### 3.2 PDF 報告生成

**功能描述**:

- 使用 jsPDF 生成訓練報告 PDF
- 需要安裝 jsPDF 依賴

**實現要點**:

- 安裝 `jspdf` 套件
- 擴展 `src/utils/reportGenerator.js` 添加 PDF 生成功能
- 在分享選單中添加「下載 PDF 報告」選項

**預期收益**: 提供更專業的報告格式

---

### 3.3 定期備份提醒

**功能描述**:

- 定期提醒用戶備份資料
- 可設定提醒頻率

**實現要點**:

- 在 `backupService.js` 中添加提醒邏輯
- 使用瀏覽器通知 API 或應用內提醒
- 記錄最後備份時間

**預期收益**: 提升用戶資料安全性

---

## 四、技術債務與優化

### 

### 待改進項目

- [ ] 添加 E2E 測試（Playwright 或 Cypress）
- [ ] 完善 README.md 文檔
- [ ] TypeScript 遷移（可選）
- [ ] 性能監控和錯誤追蹤（Sentry）
- [ ] CI/CD 流程完善

---

## 五、實施建議

### 

### 未來擴展項目

1. **多平台 API 同步** - 需要申請 API 權限和實現 OAuth 流程
2. **PDF 報告生成** - 需要安裝 jsPDF 套件
3. **定期備份提醒** - 可選功能，提升用戶體驗

---

## 六、未來專業化功能（待規劃）

以下兩個方向可進一步提升產品的專業度與 AI 智能深度，建議作為下一階段演進目標。

### 6.1 比賽配速策略計算器（Race Strategy Generator）

**理由（Math/Performance）**：

- 針對「半馬破 2」這類目標，單純的平均配速（Average Pace）是不夠的
- 實務上會採用 Negative Split（負分段）、補給時機、賽道起伏來調整策略

**功能描述**：

- **輸入**：
- 目標成績（例如：`1:59:00`）
- 賽道類型（平路 / 起伏）
- 可選：個人 FTP / 閾值配速、歷史比賽成績
- **輸出策略**：
- Negative Split（負分段）策略：
  - 例如：前 10K 配速 5:45/km，後 11K 配速 5:35/km
  - 可根據使用者耐力曲線與過往訓練自動微調
- 補給策略：
  - 結合現有營養模組，在時間軸上標記「能量膠攝取點」
  - 例如：比賽第 45 分鐘、第 90 分鐘，自動對應到距離與補給提醒
- **輸出格式**：
- 可視化表格：每 1K / 每 5K 的目標時間、累積時間、區間配速
- 圖表：配速隨距離變化的折線圖，標出關鍵分段
- 「配速手環」PDF：
  - 產生可列印的配速條（每公里目標時間），方便跑者剪下貼在手上

**實現要點**：

- 在 `src/utils/workoutCalculations.js` 中新增配速策略計算函數
- 在 `TrainingPlanView` 中增加「比賽策略」子頁或彈窗，讓使用者輸入目標成績與賽道資訊
- 使用現有報表模組（`reportGenerator.js`）生成 PDF 或圖片版配速手環
- 未來可與 Calendar 整合，在比賽日前自動顯示「比賽配速策略」卡片

**預期收益**：

- 從「訓練計畫」延伸到「比賽日策略」，讓產品覆蓋完整訓練週期
- 結合現有營養模組，提供更貼近實戰的補給建議
- 提升對中高階跑者與教練的吸引力

---

### 6.2 RAG 個人化知識庫（Retrieval-Augmented Generation）

**理由（AI Engineering）**：

- 目前 Prompt Context 受限於 token 數量，無法長期記住使用者三個月前的日記、傷痛史、物理治療建議
- 若能結合 RAG（檢索增強生成），AI 教練可以在回答問題時「回顧」過去所有重要紀錄，提升連續性與信任感

**功能描述**：

- **資料來源**：
- 訓練日記（例如：Calendar 備註欄位）
- 傷痛紀錄（例如：特定 tag 或 Injury log）
- 物理治療／復健建議（使用者自填或教練輸入）
- **技術架構**：
- 引入向量搜尋（Vector Search）：
  - 可選：Firebase Vector Search 擴充功能、Pinecone、Supabase Vector 等
- 將上述文字內容轉為 Embeddings（向量）並儲存
- **使用場景**：
- 當使用者問 AI：
  - 例：「我左膝蓋最近有點怪怪的」
- AI 不只看本週數據，還會檢索：
  - 「你兩個月前的 10/15 也有紀錄過左膝外側緊繃，當時是因為跑坡訓練過多……」
- 回覆中自動引用過往紀錄片段，讓回答具備「記憶溫度」

**實現要點**：

- 在 `aiContextService` / `contextManager` 中擴展一層 RAG 流程：
- 先用關鍵字 / Embedding 檢索出最相關的 N 筆歷史紀錄
- 再將這些紀錄作為 Context 傳給 Gemini
- 新增 `ai/knowledgeBaseService.js`（或類似命名）：
- 負責寫入 / 更新 / 刪除 Embeddings
- 封裝向量搜尋邏輯，避免洩漏具體供應商細節（Firebase / Pinecone 可替換）
- UI 層新增：
- 在教練聊天視窗中標註「本次回答參考了以下歷史紀錄：…」
- 在 Profile 或設定中，提供「匯出 / 刪除個人知識庫」的隱私控制選項

**預期收益**：

- 讓 AI 教練具備長期記憶能力，而不受單次 Prompt token 限制
- 在傷痛管理、長期計畫調整、心理狀態追蹤等情境中，提供更貼近真人教練的體驗
- 打造差異化賣點，讓產品從「通用健身 AI」進化為「真正懂你的私人教練」